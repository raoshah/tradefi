<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
            "NAVINFLUOR28MAR24FUT": "66471",
    "BAJAJFINSV28MAR24FUT": "40440",
    "OFSS28MAR24FUT": "66480",
    "ICICIPRULI28MAR24FUT": "60751",
    "TATAMOTORS28MAR24FUT": "66519",
    "TITAN28MAR24FUT": "66524",
    "LALPATHLAB28MAR24FUT": "66436",
    "CONCOR28MAR24FUT": "48013",
    "AXISBANK28MAR24FUT": "38824",
    "PNB28MAR24FUT": "66494",
    "BRITANNIA28MAR24FUT": "44200",
    "M&M28MAR24FUT": "66443",
    "IOC28MAR24FUT": "63645",
    "LUPIN28MAR24FUT": "66442",
    "BANKNIFTY28MAR24FUT": "36611",
    "CHOLAFIN28MAR24FUT": "46033",
    "NMDC28MAR24FUT": "66477",
    "ADANIPORTS28MAR24FUT": "38787",
    "TCS28MAR24FUT": "66522",
    "EICHERMOT28MAR24FUT": "50767",
    "SAIL28MAR24FUT": "66505",
    "M&MFIN28MAR24FUT": "66444",
    "GRASIM28MAR24FUT": "52107",
    "JUBLFOOD28MAR24FUT": "64122",
    "RECLTD28MAR24FUT": "66503",
    "BIOCON28MAR24FUT": "44196",
    "MIDCPNIFTY22MAR24FUT": "35707",
    "CANBK28MAR24FUT": "45482",
    "JSWSTEEL28MAR24FUT": "64121",
    "ABFRL28MAR24FUT": "38782",
    "ESCORTS28MAR24FUT": "50768",
    "BATAINDIA28MAR24FUT": "42911",
    "INDIACEM28MAR24FUT": "62121",
    "TRENT28MAR24FUT": "66528",
    "BHARTIARTL28MAR24FUT": "42916",
    "TORNTPHARM28MAR24FUT": "66525",
    "MARUTI28MAR24FUT": "66447",
    "CUB28MAR24FUT": "48026",
    "HCLTECH28MAR24FUT": "52111",
    "APOLLOTYRE28MAR24FUT": "38797",
    "AARTIIND28MAR24FUT": "38655",
    "SUNPHARMA28MAR24FUT": "66513",
    "GMRINFRA28MAR24FUT": "52101",
    "SBICARD28MAR24FUT": "66506",
    "ITC28MAR24FUT": "63648",
    "HDFCAMC28MAR24FUT": "52112",
    "COFORGE28MAR24FUT": "48011",
    "TVSMOTOR28MAR24FUT": "66529",
    "IDFCFIRSTB28MAR24FUT": "60758",
    "ASIANPAINT28MAR24FUT": "38801",
    "CHAMBLFERT28MAR24FUT": "45486",
    "GUJGASLTD28MAR24FUT": "52108",
    "IEX28MAR24FUT": "60759",
    "ICICIBANK28MAR24FUT": "59234",
    "TATACONSUM28MAR24FUT": "66518",
    "MFSL28MAR24FUT": "66451",
    "CROMPTON28MAR24FUT": "48016",
    "SBIN28MAR24FUT": "66508",
    "MARICO28MAR24FUT": "66446",
    "UPL28MAR24FUT": "66536",
    "UBL28MAR24FUT": "66532",
    "NAUKRI28MAR24FUT": "66470",
    "LAURUSLABS28MAR24FUT": "66437",
    "BANDHANBNK28MAR24FUT": "40444",
    "INDUSINDBK28MAR24FUT": "62148",
    "ABCAPITAL28MAR24FUT": "38781",
    "COLPAL28MAR24FUT": "48012",
    "SYNGENE28MAR24FUT": "66515",
    "LICHSGFIN28MAR24FUT": "66438",
    "DIXON28MAR24FUT": "50764",
    "VOLTAS28MAR24FUT": "66540",
    "BHARATFORG28MAR24FUT": "42915",
    "VEDL28MAR24FUT": "66537",
    "NIFTY28MAR24FUT": "36612",
    "PETRONET28MAR24FUT": "66489",
    "MOTHERSON28MAR24FUT": "66453",
    "ZYDUSLIFE28MAR24FUT": "66545",
    "MCDOWELL-N28MAR24FUT": "66448",
    "AUBANK28MAR24FUT": "38822",
    "GNFC28MAR24FUT": "52102",
    "SHRIRAMFIN28MAR24FUT": "66510",
    "AMBUJACEM28MAR24FUT": "38789",
    "RELIANCE28MAR24FUT": "66504",
    "PVRINOX28MAR24FUT": "66500",
    "DLF28MAR24FUT": "50765",
    "TATACHEM28MAR24FUT": "66516",
    "MUTHOOTFIN28MAR24FUT": "66464",
    "INDIAMART28MAR24FUT": "62122",
    "ACC28MAR24FUT": "38783",
    "ALKEM28MAR24FUT": "38788",
    "DIVISLAB28MAR24FUT": "50763",
    "CANFINHOME28MAR24FUT": "45483",
    "FEDERALBNK28MAR24FUT": "50772",
    "HAL28MAR24FUT": "52109",
    "INDUSTOWER28MAR24FUT": "63643",
    "INDIGO28MAR24FUT": "62147",
    "BAJFINANCE28MAR24FUT": "40441",
    "BANKBARODA28MAR24FUT": "40445",
    "MCX28MAR24FUT": "66449",
    "WIPRO28MAR24FUT": "66541",
    "AUROPHARMA28MAR24FUT": "38823",
    "CUMMINSIND28MAR24FUT": "48028",
    "TATACOMM28MAR24FUT": "66517",
    "GODREJCP28MAR24FUT": "52104",
    "ABBOTINDIA28MAR24FUT": "38780",
    "JINDALSTEL28MAR24FUT": "64119",
    "TECHM28MAR24FUT": "66523",
    "ASHOKLEY28MAR24FUT": "38800",
    "FINNIFTY26MAR24FUT": "35020",
    "COALINDIA28MAR24FUT": "48008",
    "NTPC28MAR24FUT": "66478",
    "INFY28MAR24FUT": "63644",
    "IGL28MAR24FUT": "62119",
    "DALBHARAT28MAR24FUT": "50761",
    "NATIONALUM28MAR24FUT": "66465",
    "INDHOTEL28MAR24FUT": "62120",
    "NESTLEIND28MAR24FUT": "66476",
    "POWERGRID28MAR24FUT": "66499",
    "SHREECEM28MAR24FUT": "66509",
    "COROMANDEL28MAR24FUT": "48015",
    "HINDCOPPER28MAR24FUT": "59229",
    "BAJAJ-AUTO28MAR24FUT": "38825",
    "BALKRISIND28MAR24FUT": "40442",
    "JKCEMENT28MAR24FUT": "64120",
    "HDFCLIFE28MAR24FUT": "52114",
    "GRANULES28MAR24FUT": "52106",
    "EXIDEIND28MAR24FUT": "50769",
    "APOLLOHOSP28MAR24FUT": "38796",
    "SRF28MAR24FUT": "66512",
    "SBILIFE28MAR24FUT": "66507",
    "BOSCHLTD28MAR24FUT": "44197",
    "CIPLA28MAR24FUT": "46034",
    "BSOFT28MAR24FUT": "45481",
    "IDFC28MAR24FUT": "60753",
    "KOTAKBANK28MAR24FUT": "64123",
    "PERSISTENT28MAR24FUT": "66488",
    "ABB28MAR24FUT": "38656",
    "ADANIENT28MAR24FUT": "38786",
    "ATUL28MAR24FUT": "38815",
    "LTIM28MAR24FUT": "66440",
    "MRF28MAR24FUT": "66455",
    "ULTRACEMCO28MAR24FUT": "66533",
    "L&TFH28MAR24FUT": "64124",
    "DRREDDY28MAR24FUT": "50766",
    "IDEA28MAR24FUT": "60752",
    "MGL28MAR24FUT": "66452",
    "OBEROIRLTY28MAR24FUT": "66479",
    "GODREJPROP28MAR24FUT": "52105",
    "PIIND28MAR24FUT": "66493",
    "METROPOLIS28MAR24FUT": "66450",
    "MPHASIS28MAR24FUT": "66454",
    "LTTS28MAR24FUT": "66441",
    "HINDPETRO28MAR24FUT": "59230",
    "PEL28MAR24FUT": "66487",
    "IRCTC28MAR24FUT": "63647",
    "BHEL28MAR24FUT": "42925",
    "BERGEPAINT28MAR24FUT": "42913",
    "BPCL28MAR24FUT": "44199",
    "ICICIGI28MAR24FUT": "60748",
    "BALRAMCHIN28MAR24FUT": "40443",
    "RBLBANK28MAR24FUT": "66502",
    "PIDILITIND28MAR24FUT": "66491",
    "TATASTEEL28MAR24FUT": "66521",
    "ASTRAL28MAR24FUT": "38814",
    "HDFCBANK28MAR24FUT": "52113",
    "DEEPAKNTR28MAR24FUT": "50762",
    "ZEEL28MAR24FUT": "66544",
    "LT28MAR24FUT": "66439",
    "HINDUNILVR28MAR24FUT": "59231",
    "PFC28MAR24FUT": "66490",
    "POLYCAB28MAR24FUT": "66498",
    "HAVELLS28MAR24FUT": "52110",
    "PAGEIND28MAR24FUT": "66482",
    "RAMCOCEM28MAR24FUT": "66501",
    "HINDALCO28MAR24FUT": "59228",
    "BEL28MAR24FUT": "42912",
    "DABUR28MAR24FUT": "50760",
    "TATAPOWER28MAR24FUT": "66520",
    "GAIL28MAR24FUT": "50774",
    "HEROMOTOCO28MAR24FUT": "59227",
    "MANAPPURAM28MAR24FUT": "66445",
    "IPCALAB28MAR24FUT": "63646",
    "SUNTV28MAR24FUT": "66514",
    "GLENMARK28MAR24FUT": "52097",
    "SIEMENS28MAR24FUT": "66511",
    
    
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> ONGC28MAR24FUT": "66481"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>