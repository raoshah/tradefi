<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {

            "ABB27MAR25FUT": "35003",
    "ABFRL27MAR25FUT": "35025",
    "ADANIPORTS27MAR25FUT": "35185",
    "BOSCHLTD27MAR25FUT": "35362",
    "BPCL27MAR25FUT": "35400",
    "BRITANNIA27MAR25FUT": "35401",
    "COALINDIA27MAR25FUT": "35533",
    "CONCOR27MAR25FUT": "35565",
    "DRREDDY27MAR25FUT": "35968",
    "HAVELLS27MAR25FUT": "39345",
    "IGL27MAR25FUT": "40388",
    "INDUSTOWER27MAR25FUT": "40410",
    "JSWENERGY27MAR25FUT": "41610",
    "JSWSTEEL27MAR25FUT": "41615",
    "KPITTECH27MAR25FUT": "42278",
    "LTIM27MAR25FUT": "43122",
    "NESTLEIND27MAR25FUT": "43227",
    "OBEROIRLTY27MAR25FUT": "43251",
    "PNB27MAR25FUT": "43311",
    "SHRIRAMFIN27MAR25FUT": "43357",
    "SONACOMS27MAR25FUT": "43365",
    "FINNIFTY27MAR25FUT": "35004",
    "ANGELONE27MAR25FUT": "35195",
    "BANKBARODA27MAR25FUT": "35345",
    "BHEL27MAR25FUT": "35359",
    "CANBK27MAR25FUT": "35406",
    "CHOLAFIN27MAR25FUT": "35432",
    "CROMPTON27MAR25FUT": "35570",
    "GAIL27MAR25FUT": "36398",
    "HDFCBANK27MAR25FUT": "39354",
    "JSL27MAR25FUT": "41577",
    "LAURUSLABS27MAR25FUT": "43104",
    "MARUTI27MAR25FUT": "43173",
    "MGL27MAR25FUT": "43184",
    "NCC27MAR25FUT": "43212",
    "OIL27MAR25FUT": "43253",
    "PAGEIND27MAR25FUT": "43267",
    "PAYTM27MAR25FUT": "43268",
    "TATAELXSI27MAR25FUT": "43388",
    "TATAMOTORS27MAR25FUT": "43389",
    "TRENT27MAR25FUT": "43404",
    "ULTRACEMCO27MAR25FUT": "43406",
    "VEDL27MAR25FUT": "43428",
    "NIFTYNXT5027MAR25FUT": "35005",
    "ADANIGREEN27MAR25FUT": "35060",
    "APOLLOHOSP27MAR25FUT": "35203",
    "BAJAJ-AUTO27MAR25FUT": "35247",
    "BERGEPAINT27MAR25FUT": "35356",
    "CHAMBLFERT27MAR25FUT": "35428",
    "DABUR27MAR25FUT": "35793",
    "INDUSINDBK27MAR25FUT": "40399",
    "MAXHEALTH27MAR25FUT": "43174",
    "MPHASIS27MAR25FUT": "43195",
    "MUTHOOTFIN27MAR25FUT": "43199",
    "PERSISTENT27MAR25FUT": "43277",
    "POWERGRID27MAR25FUT": "43328",
    "RECLTD27MAR25FUT": "43342",
    "SBIN27MAR25FUT": "43355",
    "TATACHEM27MAR25FUT": "43377",
    "TATAPOWER27MAR25FUT": "43390",
    "TITAN27MAR25FUT": "43400",
    "UNIONBANK27MAR25FUT": "43407",
    "TATATECH27MAR25FUT": "57535",
    "APLAPOLLO27MAR25FUT": "35201",
    "ATGL27MAR25FUT": "35223",
    "BAJAJFINSV27MAR25FUT": "35274",
    "BANDHANBNK27MAR25FUT": "35333",
    "BANKINDIA27MAR25FUT": "35350",
    "BIOCON27MAR25FUT": "35361",
    "CDSL27MAR25FUT": "35410",
    "COFORGE27MAR25FUT": "35560",
    "CYIENT27MAR25FUT": "35769",
    "DALBHARAT27MAR25FUT": "35797",
    "FEDERALBNK27MAR25FUT": "36389",
    "GRASIM27MAR25FUT": "39052",
    "HCLTECH27MAR25FUT": "39346",
    "HINDPETRO27MAR25FUT": "39902",
    "IDFCFIRSTB27MAR25FUT": "40385",
    "IEX27MAR25FUT": "40386",
    "IOC27MAR25FUT": "40478",
    "IRB27MAR25FUT": "40481",
    "JKCEMENT27MAR25FUT": "41576",
    "KEI27MAR25FUT": "41620",
    "KOTAKBANK27MAR25FUT": "42277",
    "POLICYBZR27MAR25FUT": "43312",
    "SBILIFE27MAR25FUT": "43351",
    "SUNPHARMA27MAR25FUT": "43369",
    "SUPREMEIND27MAR25FUT": "43370",
    "TATASTEEL27MAR25FUT": "43391",
    "TORNTPHARM27MAR25FUT": "43401",
    "UPL27MAR25FUT": "43418",
    "ADANIENT27MAR25FUT": "35057",
    "ALKEM27MAR25FUT": "35187",
    "APOLLOTYRE27MAR25FUT": "35212",
    "ASIANPAINT27MAR25FUT": "35215",
    "AUROPHARMA27MAR25FUT": "35232",
    "BEL27MAR25FUT": "35351",
    "CGPOWER27MAR25FUT": "35427",
    "CIPLA27MAR25FUT": "35524",
    "DELHIVERY27MAR25FUT": "35801",
    "GLENMARK27MAR25FUT": "37309",
    "HAL27MAR25FUT": "39344",
    "HDFCLIFE27MAR25FUT": "39357",
    "HUDCO27MAR25FUT": "39905",
    "INDHOTEL27MAR25FUT": "40392",
    "INDIGO27MAR25FUT": "40397",
    "INFY27MAR25FUT": "40412",
    "IRFC27MAR25FUT": "40485",
    "JIOFIN27MAR25FUT": "41574",
    "LTF27MAR25FUT": "43121",
    "PFC27MAR25FUT": "43297",
    "POLYCAB27MAR25FUT": "43313",
    "PRESTIGE27MAR25FUT": "43329",
    "TVSMOTOR27MAR25FUT": "43405",
    "UNITDSPR27MAR25FUT": "43417",
    "TATACONSUM27MAR25FUT": "43387",
    "VBL27MAR25FUT": "43427",
    "WIPRO27MAR25FUT": "43438",
    "PATANJALI27MAR25FUT": "57481",
    "BANKNIFTY27MAR25FUT": "58958",
    "IREDA27MAR25FUT": "57337",
    "MIDCPNIFTY27MAR25FUT": "35000",
    "ASTRAL27MAR25FUT": "35216",
    "AXISBANK27MAR25FUT": "35245",
    "BHARTIARTL27MAR25FUT": "35358",
    "CESC27MAR25FUT": "35411",
    "CAMS27MAR25FUT": "35405",
    "COLPAL27MAR25FUT": "35564",
    "ESCORTS27MAR25FUT": "36227",
    "SOLARINDS27MAR25FUT": "73570",
    "ACC27MAR25FUT": "35052",
    "AMBUJACEM27MAR25FUT": "35188",
    "ASHOKLEY27MAR25FUT": "35213",
    "BAJFINANCE27MAR25FUT": "35275",
    "BALKRISIND27MAR25FUT": "35332",
    "BHARATFORG27MAR25FUT": "35357",
    "DIVISLAB27MAR25FUT": "35802",
    "DMART27MAR25FUT": "35861",
    "GODREJCP27MAR25FUT": "37337",
    "HINDCOPPER27MAR25FUT": "39368",
    "HINDUNILVR27MAR25FUT": "39903",
    "ICICIBANK27MAR25FUT": "39910",
    "IDEA27MAR25FUT": "40384",
    "LODHA27MAR25FUT": "43119",
    "LT27MAR25FUT": "43120",
    "LTTS27MAR25FUT": "43152",
    "M&M27MAR25FUT": "43156",
    "NTPC27MAR25FUT": "43230",
    "OFSS27MAR25FUT": "43252",
    "PIDILITIND27MAR25FUT": "43298",
    "PIIND27MAR25FUT": "43310",
    "POONAWALLA27MAR25FUT": "43327",
    "RAMCOCEM27MAR25FUT": "43330",
    "SAIL27MAR25FUT": "43344",
    "SJVN27MAR25FUT": "43360",
    "SRF27MAR25FUT": "43368",
    "SYNGENE27MAR25FUT": "43371",
    "TCS27MAR25FUT": "43392",
    "TECHM27MAR25FUT": "43396",
    "ZOMATO27MAR25FUT": "43451",
    "IIFL27MAR25FUT": "57268",
    "AARTIIND27MAR25FUT": "35002",
    "ABCAPITAL27MAR25FUT": "35008",
    "ADANIENSOL27MAR25FUT": "35053",
    "BSOFT27MAR25FUT": "35404",
    "CUMMINSIND27MAR25FUT": "35571",
    "DIXON27MAR25FUT": "35816",
    "DLF27MAR25FUT": "35817",
    "EXIDEIND27MAR25FUT": "36388",
    "GODREJPROP27MAR25FUT": "37352",
    "GRANULES27MAR25FUT": "39049",
    "HDFCAMC27MAR25FUT": "39353",
    "HEROMOTOCO27MAR25FUT": "39362",
    "ICICIGI27MAR25FUT": "39929",
    "LICHSGFIN27MAR25FUT": "43113",
    "LICI27MAR25FUT": "43114",
    "M&MFIN27MAR25FUT": "43157",
    "MCX27MAR25FUT": "43175",
    "NHPC27MAR25FUT": "43228",
    "NYKAA27MAR25FUT": "43250",
    "RELIANCE27MAR25FUT": "43343",
    "SBICARD27MAR25FUT": "43349",
    "NIFTY27MAR25FUT": "35001",
    "AUBANK27MAR25FUT": "35225",
    "BSE27MAR25FUT": "35403",
    "DEEPAKNTR27MAR25FUT": "35798",
    "EICHERMOT27MAR25FUT": "35985",
    "ICICIPRULI27MAR25FUT": "39930",
    "INDIANB27MAR25FUT": "40393",
    "JUBLFOOD27MAR25FUT": "41616",
    "MANAPPURAM27MAR25FUT": "43158",
    "MOTHERSON27MAR25FUT": "43188",
    "NMDC27MAR25FUT": "43229",
    "PETRONET27MAR25FUT": "43278",
    "RBLBANK27MAR25FUT": "43339",
    "TATACOMM27MAR25FUT": "43378",
    "TIINDIA27MAR25FUT": "43397",
    "ZYDUSLIFE27MAR25FUT": "43462",
    "PHOENIXLTD27MAR25FUT": "73522",
    "GMRAIRPORT27MAR25FUT": "37310",
    "TITAGARH27MAR25FUT": "57541",
    "HFCL27MAR25FUT": "39363",
    "HINDALCO27MAR25FUT": "39366",
    "IRCTC27MAR25FUT": "40482",
    "ITC27MAR25FUT": "41029",
    "JINDALSTEL27MAR25FUT": "41033",
    "KALYANKJIL27MAR25FUT": "41617",
    "LUPIN27MAR25FUT": "43153",
    "MARICO27MAR25FUT": "43160",
    "MFSL27MAR25FUT": "43177",
    "MRF27MAR25FUT": "43196",
    "NATIONALUM27MAR25FUT": "43200",
    "NAUKRI27MAR25FUT": "43211",
    "ONGC27MAR25FUT": "43266",
    "PEL27MAR25FUT": "43269",
    "SHREECEM27MAR25FUT": "43356",
    "SIEMENS27MAR25FUT": "43358",
    "VOLTAS27MAR25FUT": "43437",
    "YESBANK27MAR25FUT": "43450",
    "TORNTPOWER27MAR25FUT": "73656",
    "NBCC27MAR25FUT": "73503",
    "SILVER05MAR25FUT": "429815",
    "ALUMINI31MAR25FUT": "442159",
    "GOLDPETAL31MAR25FUT": "444540",
    "GOLDM05MAR25FUT": "444629",
    "MCXMETLDEX21MAR25FUT": "445013",
    "COTTONCNDY31MAR25FUT": "439040",
    "LEAD31MAR25FUT": "442163",
    "STEELREBAR31MAR25FUT": "442165",
    "ALUMINIUM31MAR25FUT": "442160",
    "COPPER31MAR25FUT": "442161",
    "LEADMINI31MAR25FUT": "442162",
    "CRUDEOIL19MAR25FUT": "439829",
    "NICKEL31MAR25FUT": "442164",
    "NATURALGAS26MAR25FUT": "440248",
    "CRUDEOILM19MAR25FUT": "439830",
    "ZINC31MAR25FUT": "442167",
    "GOLDGUINEA31MAR25FUT": "444539",
    "MCXBULLDEX26MAR25FUT": "446049",
    "MENTHAOIL31MAR25FUT": "440574",
    "ZINCMINI31MAR25FUT": "442166",
    "COTTONOIL31MAR25FUT": "444538",
   

            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> NATGASMINI26MAR25FUT": "440249"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
