<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
            "TATAMOTORS30MAY24FUT": "56400",
            "JINDALSTEL30MAY24FUT": "51035",
            "DRREDDY30MAY24FUT": "50988",
            "MARICO30MAY24FUT": "52310",
            "OBEROIRLTY30MAY24FUT": "52839",
            "LAURUSLABS30MAY24FUT": "51042",
            "MANAPPURAM30MAY24FUT": "51056",
            "VEDL30MAY24FUT": "56414",
            "SUNTV30MAY24FUT": "56393",
            "UPL30MAY24FUT": "56413",
            "ULTRACEMCO30MAY24FUT": "56412",
            "APOLLOTYRE30MAY24FUT": "48453",
            "M&M30MAY24FUT": "51054",
            "HAL30MAY24FUT": "51002",
            "TATAPOWER30MAY24FUT": "56401",
            "DIXON30MAY24FUT": "50986",
            "MUTHOOTFIN30MAY24FUT": "52665",
            "NAUKRI30MAY24FUT": "52667",
            "LICHSGFIN30MAY24FUT": "51044",
            "BAJFINANCE30MAY24FUT": "50931",
            "WIPRO30MAY24FUT": "56416",
            "PIDILITIND30MAY24FUT": "55060",
            "HDFCLIFE30MAY24FUT": "51007",
            "PEL30MAY24FUT": "53071",
            "HINDPETRO30MAY24FUT": "51011",
            "OFSS30MAY24FUT": "52845",
            "JSWSTEEL30MAY24FUT": "51037",
            "TITAN30MAY24FUT": "56405",
            "ZYDUSLIFE30MAY24FUT": "56418",
            "CHAMBLFERT30MAY24FUT": "50950",
            "SIEMENS30MAY24FUT": "56390",
            "ASHOKLEY30MAY24FUT": "48456",
            "TCS30MAY24FUT": "56403",
            "IDEA30MAY24FUT": "51016",
            "PVRINOX30MAY24FUT": "56020",
            "TRENT30MAY24FUT": "56407",
            "INDUSTOWER30MAY24FUT": "51029",
            "ESCORTS30MAY24FUT": "50990",
            "HDFCAMC30MAY24FUT": "51005",
            "PAGEIND30MAY24FUT": "53012",
            "GAIL30MAY24FUT": "50993",
            "BERGEPAINT30MAY24FUT": "50938",
            "MARUTI30MAY24FUT": "52354",
            "SHRIRAMFIN30MAY24FUT": "56389",
            "PFC30MAY24FUT": "55059",
            "MGL30MAY24FUT": "52595",
            "GNFC30MAY24FUT": "50996",
            "ICICIGI30MAY24FUT": "51014",
            "FINNIFTY28MAY24FUT": "35089",
            "LTTS30MAY24FUT": "51051",
            "HINDCOPPER30MAY24FUT": "51010",
            "AUBANK30MAY24FUT": "50926",
            "CANFINHOME30MAY24FUT": "50949",
            "TORNTPHARM30MAY24FUT": "56406",
            "ICICIPRULI30MAY24FUT": "51015",
            "DIVISLAB30MAY24FUT": "50985",
            "IOC30MAY24FUT": "51031",
            "SAIL30MAY24FUT": "56039",
            "AUROPHARMA30MAY24FUT": "50927",
            "MCX30MAY24FUT": "52359",
            "MIDCPNIFTY27MAY24FUT": "35709",
            "CUB30MAY24FUT": "50975",
            "POWERGRID30MAY24FUT": "56017",
            "MRF30MAY24FUT": "52598",
            "BOSCHLTD30MAY24FUT": "50944",
            "AARTIIND30MAY24FUT": "46931",
            "DEEPAKNTR30MAY24FUT": "50983",
            "SBIN30MAY24FUT": "56387",
            "ABBOTINDIA30MAY24FUT": "46933",
            "HEROMOTOCO30MAY24FUT": "51008",
            "DLF30MAY24FUT": "50987",
            "M&MFIN30MAY24FUT": "51055",
            "IGL30MAY24FUT": "51023",
            "COFORGE30MAY24FUT": "50954",
            "COALINDIA30MAY24FUT": "50953",
            "NMDC30MAY24FUT": "52673",
            "RELIANCE30MAY24FUT": "56038",
            "IEX30MAY24FUT": "51022",
            "ITC30MAY24FUT": "51034",
            "ADANIENT30MAY24FUT": "47456",
            "INDHOTEL30MAY24FUT": "51024",
            "ASIANPAINT30MAY24FUT": "48457",
            "IDFC30MAY24FUT": "51017",
            "TATACOMM30MAY24FUT": "56396",
            "ZEEL30MAY24FUT": "56417",
            "MOTHERSON30MAY24FUT": "52596",
            "BPCL30MAY24FUT": "50945",
            "VOLTAS30MAY24FUT": "56415",
            "LUPIN30MAY24FUT": "51052",
            "NAVINFLUOR30MAY24FUT": "52668",
            "BANKBARODA30MAY24FUT": "50935",
            "DALBHARAT30MAY24FUT": "50982",
            "ABCAPITAL30MAY24FUT": "47144",
            "ALKEM30MAY24FUT": "47458",
            "FEDERALBNK30MAY24FUT": "50992",
            "HAVELLS30MAY24FUT": "51003",
            "SUNPHARMA30MAY24FUT": "56392",
            "TATASTEEL30MAY24FUT": "56402",
            "BATAINDIA30MAY24FUT": "50936",
            "ICICIBANK30MAY24FUT": "51013",
            "TATACHEM30MAY24FUT": "56395",
            "CONCOR30MAY24FUT": "50959",
            "IDFCFIRSTB30MAY24FUT": "51021",
            "BHARTIARTL30MAY24FUT": "50941",
            "INDUSINDBK30MAY24FUT": "51028",
            "IPCALAB30MAY24FUT": "51032",
            "GODREJPROP30MAY24FUT": "50998",
            "BHARATFORG30MAY24FUT": "50939",
            "RBLBANK30MAY24FUT": "56022",
            "DABUR30MAY24FUT": "50980",
            "COROMANDEL30MAY24FUT": "50968",
            "BAJAJFINSV30MAY24FUT": "50930",
            "BSOFT30MAY24FUT": "50947",
            "METROPOLIS30MAY24FUT": "52367",
            "HINDUNILVR30MAY24FUT": "51012",
            "BEL30MAY24FUT": "50937",
            "PIIND30MAY24FUT": "56014",
            "KOTAKBANK30MAY24FUT": "51039",
            "BANKNIFTY29MAY24FUT": "46923",
            "BIOCON30MAY24FUT": "50943",
            "INFY30MAY24FUT": "51030",
            "SYNGENE30MAY24FUT": "56394",
            "CHOLAFIN30MAY24FUT": "50951",
            "TATACONSUM30MAY24FUT": "56397",
            "SBICARD30MAY24FUT": "56044",
            "BHEL30MAY24FUT": "50942",
            "GRANULES30MAY24FUT": "50999",
            "ACC30MAY24FUT": "47455",
            "BAJAJ-AUTO30MAY24FUT": "50929",
            "BANDHANBNK30MAY24FUT": "50934",
            "NIFTYNXT5031MAY24FUT": "35236",
            "HINDALCO30MAY24FUT": "51009",
            "GODREJCP30MAY24FUT": "50997",
            "POLYCAB30MAY24FUT": "56016",
            "INDIAMART30MAY24FUT": "51026",
            "MCDOWELL-N30MAY24FUT": "52358",
            "NATIONALUM30MAY24FUT": "52666",
            "BRITANNIA30MAY24FUT": "50946",
            "CUMMINSIND30MAY24FUT": "50977",
            "CROMPTON30MAY24FUT": "50974",
            "GLENMARK30MAY24FUT": "50994",
            "JKCEMENT30MAY24FUT": "51036",
            "ADANIPORTS30MAY24FUT": "47457",
            "LTIM30MAY24FUT": "51050",
            "HCLTECH30MAY24FUT": "51004",
            "GRASIM30MAY24FUT": "51000",
            "IRCTC30MAY24FUT": "51033",
            "ONGC30MAY24FUT": "52846",
            "SBILIFE30MAY24FUT": "56045",
            "INDIACEM30MAY24FUT": "51025",
            "ASTRAL30MAY24FUT": "48458",
            "UBL30MAY24FUT": "56411",
            "LALPATHLAB30MAY24FUT": "51041",
            "EICHERMOT30MAY24FUT": "50989",
            "TVSMOTOR30MAY24FUT": "56410",
            "TECHM30MAY24FUT": "56404",
            "ABB30MAY24FUT": "46932",
            "GUJGASLTD30MAY24FUT": "51001",
            "GMRINFRA30MAY24FUT": "50995",
            "BALKRISIND30MAY24FUT": "50932",
            "ATUL30MAY24FUT": "50925",
            "COLPAL30MAY24FUT": "50955",
            "SRF30MAY24FUT": "56391",
            "JUBLFOOD30MAY24FUT": "51038",
            "PNB30MAY24FUT": "56015",
            "AXISBANK30MAY24FUT": "50928",
            "AMBUJACEM30MAY24FUT": "47459",
            "PERSISTENT30MAY24FUT": "54484",
            "SHREECEM30MAY24FUT": "56388",
            "MPHASIS30MAY24FUT": "52597",
            "CANBK30MAY24FUT": "50948",
            "NESTLEIND30MAY24FUT": "52672",
            "RECLTD30MAY24FUT": "56023",
            "BALRAMCHIN30MAY24FUT": "50933",
            "MFSL30MAY24FUT": "52375",
            "PETRONET30MAY24FUT": "54485",
            "CIPLA30MAY24FUT": "50952",
            "EXIDEIND30MAY24FUT": "50991",
            "HDFCBANK30MAY24FUT": "51006",
            "LT30MAY24FUT": "51045",
            "NTPC30MAY24FUT": "52838",
            "RAMCOCEM30MAY24FUT": "56021",
            "LTF30MAY24FUT": "51040",
            "ABFRL30MAY24FUT": "47145",
            "APOLLOHOSP30MAY24FUT": "47460",
            "NIFTY30MAY24FUT": "46930",
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> INDIGO30MAY24FUT": "51027"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
