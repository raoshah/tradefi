<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {

            "MIDCPNIFTY24APR25FUT": "54449",
    "AARTIIND24APR25FUT": "54454",
    "ABFRL24APR25FUT": "54457",
    "NIFTYNXT5024APR25FUT": "54453",
    "ADANIGREEN24APR25FUT": "54834",
    "AMBUJACEM24APR25FUT": "57247",
    "ALKEM24APR25FUT": "57246",
    "IIFL24APR25FUT": "57269",
    "PATANJALI24APR25FUT": "57484",
    "ADANIPORTS24APR25FUT": "54835",
    "FINNIFTY24APR25FUT": "54446",
    "AUBANK24APR25FUT": "69082",
    "CIPLA24APR25FUT": "73274",
    "DLF24APR25FUT": "73304",
    "HCLTECH24APR25FUT": "73340",
    "IDFCFIRSTB24APR25FUT": "73398",
    "JIOFIN24APR25FUT": "73466",
    "IGL24APR25FUT": "73427",
    "M&M24APR25FUT": "73487",
    "NCC24APR25FUT": "73505",
    "NATIONALUM24APR25FUT": "73500",
    "RBLBANK24APR25FUT": "73535",
    "TATASTEEL24APR25FUT": "73626",
    "UNITDSPR24APR25FUT": "73674",
    "UPL24APR25FUT": "73675",
    "BALKRISIND24APR25FUT": "69088",
    "APLAPOLLO24APR25FUT": "65553",
    "ASIANPAINT24APR25FUT": "69079",
    "BERGEPAINT24APR25FUT": "69093",
    "BANKINDIA24APR25FUT": "69091",
    "BHEL24APR25FUT": "69096",
    "AXISBANK24APR25FUT": "69084",
    "BAJAJ-AUTO24APR25FUT": "69085",
    "BHARTIARTL24APR25FUT": "69095",
    "ADANIENT24APR25FUT": "54833",
    "TITAGARH24APR25FUT": "57544",
    "ABB24APR25FUT": "54455",
    "BSOFT24APR25FUT": "73263",
    "BSE24APR25FUT": "73262",
    "CAMS24APR25FUT": "73266",
    "CANBK24APR25FUT": "73267",
    "HAVELLS24APR25FUT": "73339",
    "GRASIM24APR25FUT": "73331",
    "EICHERMOT24APR25FUT": "73308",
    "HINDUNILVR24APR25FUT": "73370",
    "ICICIPRULI24APR25FUT": "73396",
    "IDEA24APR25FUT": "73397",
    "LUPIN24APR25FUT": "73486",
    "MUTHOOTFIN24APR25FUT": "73499",
    "PAYTM24APR25FUT": "73516",
    "PNB24APR25FUT": "73526",
    "SRF24APR25FUT": "73573",
    "SUNPHARMA24APR25FUT": "73574",
    "SYNGENE24APR25FUT": "73576",
    "TVSMOTOR24APR25FUT": "73670",
    "YESBANK24APR25FUT": "73692",
    "COALINDIA24APR25FUT": "73275",
    "CYIENT24APR25FUT": "73283",
    "ITC24APR25FUT": "73464",
    "IRFC24APR25FUT": "73461",
    "JINDALSTEL24APR25FUT": "73465",
    "LICI24APR25FUT": "73481",
    "MCX24APR25FUT": "73493",
    "SHRIRAMFIN24APR25FUT": "73566",
    "TATACHEM24APR25FUT": "73577",
    "TORNTPOWER24APR25FUT": "73657",
    "CHOLAFIN24APR25FUT": "73273",
    "DABUR24APR25FUT": "73284",
    "CROMPTON24APR25FUT": "73281",
    "HAL24APR25FUT": "73338",
    "GRANULES24APR25FUT": "73330",
    "HINDALCO24APR25FUT": "73348",
    "INDUSTOWER24APR25FUT": "73433",
    "INDHOTEL24APR25FUT": "73428",
    "JSWSTEEL24APR25FUT": "73469",
    "IRCTC24APR25FUT": "73460",
    "LTF24APR25FUT": "73484",
    "LTIM24APR25FUT": "73485",
    "MOTHERSON24APR25FUT": "73496",
    "MRF24APR25FUT": "73498",
    "NAUKRI24APR25FUT": "73501",
    "NMDC24APR25FUT": "73508",
    "ONGC24APR25FUT": "73514",
    "PAGEIND24APR25FUT": "73515",
    "PERSISTENT24APR25FUT": "73518",
    "POLYCAB24APR25FUT": "73528",
    "PRESTIGE24APR25FUT": "73531",
    "SBIN24APR25FUT": "73564",
    "SBICARD24APR25FUT": "73562",
    "TATACOMM24APR25FUT": "73578",
    "BOSCHLTD24APR25FUT": "73149",
    "BPCL24APR25FUT": "73247",
    "COFORGE24APR25FUT": "73278",
    "CHAMBLFERT24APR25FUT": "73272",
    "DRREDDY24APR25FUT": "73306",
    "DALBHARAT24APR25FUT": "73285",
    "DEEPAKNTR24APR25FUT": "73286",
    "ICICIGI24APR25FUT": "73387",
    "INFY24APR25FUT": "73434",
    "INDIGO24APR25FUT": "73430",
    "M&MFIN24APR25FUT": "73488",
    "MFSL24APR25FUT": "73494",
    "POLICYBZR24APR25FUT": "73527",
    "RECLTD24APR25FUT": "73536",
    "POWERGRID24APR25FUT": "73530",
    "SHREECEM24APR25FUT": "73565",
    "SJVN24APR25FUT": "73568",
    "TATAELXSI24APR25FUT": "73580",
    "TATAPOWER24APR25FUT": "73625",
    "TCS24APR25FUT": "73627",
    "TATAMOTORS24APR25FUT": "73620",
    "VBL24APR25FUT": "73678",
    "APOLLOTYRE24APR25FUT": "65555",
    "ASHOKLEY24APR25FUT": "69078",
    "DMART24APR25FUT": "73305",
    "COLPAL24APR25FUT": "73279",
    "DELHIVERY24APR25FUT": "73287",
    "EXIDEIND24APR25FUT": "73310",
    "FEDERALBNK24APR25FUT": "73311",
    "HEROMOTOCO24APR25FUT": "73344",
    "IEX24APR25FUT": "73399",
    "MPHASIS24APR25FUT": "73497",
    "NBCC24APR25FUT": "73504",
    "NESTLEIND24APR25FUT": "73506",
    "NTPC24APR25FUT": "73509",
    "PETRONET24APR25FUT": "73519",
    "PFC24APR25FUT": "73520",
    "SIEMENS24APR25FUT": "73567",
    "SAIL24APR25FUT": "73561",
    "SOLARINDS24APR25FUT": "73571",
    "SUPREMEIND24APR25FUT": "73575",
    "TATACONSUM24APR25FUT": "73579",
    "SONACOMS24APR25FUT": "73572",
    "TITAN24APR25FUT": "73632",
    "TRENT24APR25FUT": "73669",
    "VEDL24APR25FUT": "73679",
    "ADANIENSOL24APR25FUT": "54832",
    "INOXWIND24APR25FUT": "56998",
    "PNBHOUSING24APR25FUT": "57089",
    "NIFTY24APR25FUT": "54452",
    "ANGELONE24APR25FUT": "65552",
    "ASTRAL24APR25FUT": "69080",
    "ATGL24APR25FUT": "69081",
    "BEL24APR25FUT": "69092",
    "BANKNIFTY24APR25FUT": "54445",
    "ACC24APR25FUT": "54458",
    "HINDZINC24APR25FUT": "56960",
    "ABCAPITAL24APR25FUT": "54456",
    "IREDA24APR25FUT": "57342",
    "TATATECH24APR25FUT": "57536",
    "CESC24APR25FUT": "73270",
    "ESCORTS24APR25FUT": "73309",
    "GLENMARK24APR25FUT": "73324",
    "HFCL24APR25FUT": "73345",
    "HDFCAMC24APR25FUT": "73341",
    "HINDPETRO24APR25FUT": "73367",
    "ICICIBANK24APR25FUT": "73386",
    "IRB24APR25FUT": "73437",
    "JSWENERGY24APR25FUT": "73468",
    "MANAPPURAM24APR25FUT": "73489",
    "MARICO24APR25FUT": "73490",
    "MAXHEALTH24APR25FUT": "73492",
    "NHPC24APR25FUT": "73507",
    "OBEROIRLTY24APR25FUT": "73511",
    "SBILIFE24APR25FUT": "73563",
    "OIL24APR25FUT": "73513",
    "UNIONBANK24APR25FUT": "73672",
    "WIPRO24APR25FUT": "73687",
    "TECHM24APR25FUT": "73628",
    "ZOMATO24APR25FUT": "73693",
    "APOLLOHOSP24APR25FUT": "65554",
    "BHARATFORG24APR25FUT": "69094",
    "CDSL24APR25FUT": "73268",
    "DIXON24APR25FUT": "73303",
    "GAIL24APR25FUT": "73323",
    "GMRAIRPORT24APR25FUT": "73325",
    "HINDCOPPER24APR25FUT": "73366",
    "HUDCO24APR25FUT": "73371",
    "GODREJPROP24APR25FUT": "73329",
    "INDIANB24APR25FUT": "73429",
    "LICHSGFIN24APR25FUT": "73480",
    "KALYANKJIL24APR25FUT": "73473",
    "KEI24APR25FUT": "73474",
    "JUBLFOOD24APR25FUT": "73472",
    "LT24APR25FUT": "73483",
    "MARUTI24APR25FUT": "73491",
    "MGL24APR25FUT": "73495",
    "PHOENIXLTD24APR25FUT": "73523",
    "PIIND24APR25FUT": "73525",
    "POONAWALLA24APR25FUT": "73529",
    "TIINDIA24APR25FUT": "73629",
    "TORNTPHARM24APR25FUT": "73633",
    "VOLTAS24APR25FUT": "73686",
    "BAJFINANCE24APR25FUT": "69087",
    "AUROPHARMA24APR25FUT": "69083",
    "BAJAJFINSV24APR25FUT": "69086",
    "BANDHANBNK24APR25FUT": "69089",
    "BIOCON24APR25FUT": "69097",
    "BANKBARODA24APR25FUT": "69090",
    "BRITANNIA24APR25FUT": "73259",
    "CGPOWER24APR25FUT": "73271",
    "DIVISLAB24APR25FUT": "73288",
    "CONCOR24APR25FUT": "73280",
    "CUMMINSIND24APR25FUT": "73282",
    "HDFCBANK24APR25FUT": "73342",
    "GODREJCP24APR25FUT": "73326",
    "HDFCLIFE24APR25FUT": "73343",
    "IOC24APR25FUT": "73436",
    "INDUSINDBK24APR25FUT": "73432",
    "JSL24APR25FUT": "73467",
    "KOTAKBANK24APR25FUT": "73475",
    "KPITTECH24APR25FUT": "73478",
    "LAURUSLABS24APR25FUT": "73479",
    "LODHA24APR25FUT": "73482",
    "PEL24APR25FUT": "73517",
    "NYKAA24APR25FUT": "73510",
    "OFSS24APR25FUT": "73512",
    "RAMCOCEM24APR25FUT": "73534",
    "PIDILITIND24APR25FUT": "73524",
    "RELIANCE24APR25FUT": "73537",
    "ULTRACEMCO24APR25FUT": "73671",
    "ZYDUSLIFE24APR25FUT": "73698",
    "ZINC30APR25FUT": "444535",
    "LEAD30APR25FUT": "444532",
    "ZINCMINI30APR25FUT": "444536",
    "STEELREBAR30APR25FUT": "444537",
    "ALUMINI30APR25FUT": "444529",
    "SILVERM30APR25FUT": "433351",
    "GOLD04APR25FUT": "431876",
    "NATURALGAS25APR25FUT": "441833",
    "ALUMINIUM30APR25FUT": "444530",
    "MENTHAOIL30APR25FUT": "442173",
    "LEADMINI30APR25FUT": "444533",
    "KAPAS30APR25FUT": "430388",
    "SILVERMIC30APR25FUT": "437994",
    "GOLDPETAL30APR25FUT": "446496",
    "GOLDM04APR25FUT": "446615",
    "COTTONOIL30APR25FUT": "446484",
    "CRUDEOIL21APR25FUT": "441305",
    "COPPER30APR25FUT": "444531",
    "NICKEL30APR25FUT": "444534",
    "MCXBULLDEX24APR25FUT": "447558",
    "CRUDEOILM21APR25FUT": "441306",
    "NATGASMINI25APR25FUT": "441834",
    "GOLDGUINEA30APR25FUT": "446495",

            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> MCXMETLDEX23APR25FUT": "447387"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
