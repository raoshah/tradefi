<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
            "NAVINFLUOR28MAR24FUT": "66471",
    "BAJAJFINSV28MAR24FUT": "40440",
    "GNFC29FEB24FUT": "71649",
    "OFSS28MAR24FUT": "66480",
    "ICICIPRULI28MAR24FUT": "60751",
    "TATAMOTORS28MAR24FUT": "66519",
    "TITAN28MAR24FUT": "66524",
    "LALPATHLAB28MAR24FUT": "66436",
    "INDHOTEL29FEB24FUT": "71688",
    "MARUTI29FEB24FUT": "71844",
    "CONCOR28MAR24FUT": "48013",
    "AXISBANK28MAR24FUT": "38824",
    "PNB28MAR24FUT": "66494",
    "BRITANNIA28MAR24FUT": "44200",
    "M&M28MAR24FUT": "66443",
    "IOC28MAR24FUT": "63645",
    "INDIACEM29FEB24FUT": "71689",
    "LUPIN28MAR24FUT": "66442",
    "PFC29FEB24FUT": "71868",
    "PNB29FEB24FUT": "71880",
    "PIIND29FEB24FUT": "71879",
    "JSWSTEEL29FEB24FUT": "71829",
    "MANAPPURAM29FEB24FUT": "71842",
    "BIOCON29FEB24FUT": "71489",
    "IDEA29FEB24FUT": "71683",
    "BANKNIFTY28MAR24FUT": "36611",
    "TATAMOTORS29FEB24FUT": "71906",
    "CHOLAFIN28MAR24FUT": "46033",
    "ADANIPORTS29FEB24FUT": "71451",
    "RAMCOCEM29FEB24FUT": "71888",
    "COFORGE29FEB24FUT": "71500",
    "NMDC28MAR24FUT": "66477",
    "PAGEIND29FEB24FUT": "71864",
    "MARICO29FEB24FUT": "71843",
    "ADANIPORTS28MAR24FUT": "38787",
    "IOC29FEB24FUT": "71697",
    "DEEPAKNTR29FEB24FUT": "71536",
    "DABUR29FEB24FUT": "71530",
    "ESCORTS29FEB24FUT": "71579",
    "UPL29FEB24FUT": "71917",
    "FEDERALBNK29FEB24FUT": "71581",
    "TCS28MAR24FUT": "66522",
    "EICHERMOT28MAR24FUT": "50767",
    "SAIL28MAR24FUT": "66505",
    "BHARTIARTL29FEB24FUT": "71487",
    "M&MFIN28MAR24FUT": "66444",
    "GRASIM28MAR24FUT": "52107",
    "JUBLFOOD28MAR24FUT": "64122",
    "GMRINFRA29FEB24FUT": "71638",
    "RECLTD28MAR24FUT": "66503",
    "BIOCON28MAR24FUT": "44196",
    "MIDCPNIFTY22MAR24FUT": "35707",
    "CANBK28MAR24FUT": "45482",
    "DRREDDY29FEB24FUT": "71577",
    "MFSL29FEB24FUT": "71848",
    "JSWSTEEL28MAR24FUT": "64121",
    "ABFRL28MAR24FUT": "38782",
    "ESCORTS28MAR24FUT": "50768",
    "BATAINDIA28MAR24FUT": "42911",
    "INDIACEM28MAR24FUT": "62121",
    "BSOFT29FEB24FUT": "71493",
    "TRENT28MAR24FUT": "66528",
    "BHARTIARTL28MAR24FUT": "42916",
    "TORNTPHARM28MAR24FUT": "66525",
    "BPCL29FEB24FUT": "71491",
    "MARUTI28MAR24FUT": "66447",
    "UBL29FEB24FUT": "71915",
    "RELIANCE29FEB24FUT": "71891",
    "BAJFINANCE29FEB24FUT": "71465",
    "BOSCHLTD29FEB24FUT": "71490",
    "CROMPTON29FEB24FUT": "71527",
    "AARTIIND29FEB24FUT": "71442",
    "CUB28MAR24FUT": "48026",
    "NMDC29FEB24FUT": "71859",
    "SRF29FEB24FUT": "71899",
    "SUNTV29FEB24FUT": "71901",
    "EICHERMOT29FEB24FUT": "71578",
    "HCLTECH28MAR24FUT": "52111",
    "TITAN29FEB24FUT": "71911",
    "APOLLOTYRE28MAR24FUT": "38797",
    "AARTIIND28MAR24FUT": "38655",
    "SUNPHARMA28MAR24FUT": "66513",
    "GMRINFRA28MAR24FUT": "52101",
    "SBICARD28MAR24FUT": "66506",
    "DIXON29FEB24FUT": "71575",
    "ULTRACEMCO29FEB24FUT": "71916",
    "ITC28MAR24FUT": "63648",
    "TRENT29FEB24FUT": "71913",
    "HDFCAMC28MAR24FUT": "52112",
    "COFORGE28MAR24FUT": "48011",
    "L&TFH29FEB24FUT": "71832",
    "TVSMOTOR28MAR24FUT": "66529",
    "SHREECEM29FEB24FUT": "71896",
    "ASIANPAINT29FEB24FUT": "71457",
    "IDFCFIRSTB28MAR24FUT": "60758",
    "EXIDEIND29FEB24FUT": "71580",
    "IPCALAB29FEB24FUT": "71698",
    "ASIANPAINT28MAR24FUT": "38801",
    "CHAMBLFERT28MAR24FUT": "45486",
    "JKCEMENT29FEB24FUT": "71813",
    "BEL29FEB24FUT": "71482",
    "CHOLAFIN29FEB24FUT": "71497",
    "NESTLEIND29FEB24FUT": "71858",
    "GUJGASLTD28MAR24FUT": "52108",
    "IGL29FEB24FUT": "71687",
    "JUBLFOOD29FEB24FUT": "71830",
    "SBILIFE29FEB24FUT": "71894",
    "RECLTD29FEB24FUT": "71890",
    "SIEMENS29FEB24FUT": "71898",
    "RBLBANK29FEB24FUT": "71889",
    "PERSISTENT29FEB24FUT": "71866",
    "GRASIM29FEB24FUT": "71663",
    "AUROPHARMA29FEB24FUT": "71461",
    "IEX28MAR24FUT": "60759",
    "BHEL29FEB24FUT": "71488",
    "M&MFIN29FEB24FUT": "71841",
    "ICICIBANK28MAR24FUT": "59234",
    "TATACONSUM28MAR24FUT": "66518",
    "MFSL28MAR24FUT": "66451",
    "TCS29FEB24FUT": "71909",
    "NIFTY29FEB24FUT": "71441",
    "CROMPTON28MAR24FUT": "48016",
    "NTPC29FEB24FUT": "71860",
    "SBIN28MAR24FUT": "66508",
    "MARICO28MAR24FUT": "66446",
    "VEDL29FEB24FUT": "71918",
    "UPL28MAR24FUT": "66536",
    "UBL28MAR24FUT": "66532",
    "NAUKRI28MAR24FUT": "66470",
    "LAURUSLABS28MAR24FUT": "66437",
    "ICICIPRULI29FEB24FUT": "71682",
    "LTTS29FEB24FUT": "71838",
    "BANDHANBNK28MAR24FUT": "40444",
    "INDUSINDBK28MAR24FUT": "62148",
    "ABCAPITAL28MAR24FUT": "38781",
    "ALKEM29FEB24FUT": "71452",
    "BANKNIFTY29FEB24FUT": "71440",
    "ICICIGI29FEB24FUT": "71681",
    "PEL29FEB24FUT": "71865",
    "COLPAL28MAR24FUT": "48012",
    "SYNGENE28MAR24FUT": "66515",
    "TORNTPHARM29FEB24FUT": "71912",
    "PIDILITIND29FEB24FUT": "71878",
    "LICHSGFIN28MAR24FUT": "66438",
    "HINDCOPPER29FEB24FUT": "71677",
    "DIXON28MAR24FUT": "50764",
    "VOLTAS28MAR24FUT": "66540",
    "BHARATFORG28MAR24FUT": "42915",
    "OBEROIRLTY29FEB24FUT": "71861",
    "HDFCLIFE29FEB24FUT": "71672",
    "VEDL28MAR24FUT": "66537",
    "ASTRAL29FEB24FUT": "71458",
    "NIFTY28MAR24FUT": "36612",
    "HDFCBANK29FEB24FUT": "71671",
    "NAUKRI29FEB24FUT": "71855",
    "PETRONET28MAR24FUT": "66489",
    "SBIN29FEB24FUT": "71895",
    "CHAMBLFERT29FEB24FUT": "71496",
    "KOTAKBANK29FEB24FUT": "71831",
    "MOTHERSON28MAR24FUT": "66453",
    "ZYDUSLIFE28MAR24FUT": "66545",
    "MCDOWELL-N28MAR24FUT": "66448",
    "LICHSGFIN29FEB24FUT": "71835",
    "HEROMOTOCO29FEB24FUT": "71673",
    "AUBANK28MAR24FUT": "38822",
    "GNFC28MAR24FUT": "52102",
    "SHRIRAMFIN28MAR24FUT": "66510",
    "AMBUJACEM28MAR24FUT": "38789",
    "RELIANCE28MAR24FUT": "66504",
    "PVRINOX28MAR24FUT": "66500",
    "GUJGASLTD29FEB24FUT": "71664",
    "BAJAJFINSV29FEB24FUT": "71464",
    "DLF28MAR24FUT": "50765",
    "TATACHEM28MAR24FUT": "66516",
    "GLENMARK29FEB24FUT": "71637",
    "MUTHOOTFIN28MAR24FUT": "66464",
    "INDIAMART28MAR24FUT": "62122",
    "ZEEL29FEB24FUT": "71921",
    "ABCAPITAL29FEB24FUT": "71445",
    "HCLTECH29FEB24FUT": "71669",
    "CUB29FEB24FUT": "71528",
    "ACC28MAR24FUT": "38783",
    "MCX29FEB24FUT": "71846",
    "ALKEM28MAR24FUT": "38788",
    "DIVISLAB28MAR24FUT": "50763",
    "IRCTC29FEB24FUT": "71810",
    "DLF29FEB24FUT": "71576",
    "BERGEPAINT29FEB24FUT": "71483",
    "INDIGO29FEB24FUT": "71691",
    "LUPIN29FEB24FUT": "71839",
    "CIPLA29FEB24FUT": "71498",
    "CANFINHOME28MAR24FUT": "45483",
    "FEDERALBNK28MAR24FUT": "50772",
    "HAL28MAR24FUT": "52109",
    "COLPAL29FEB24FUT": "71511",
    "INDUSTOWER28MAR24FUT": "63643",
    "TATACONSUM29FEB24FUT": "71905",
    "GODREJPROP29FEB24FUT": "71653",
    "INDIGO28MAR24FUT": "62147",
    "BAJFINANCE28MAR24FUT": "40441",
    "GAIL29FEB24FUT": "71582",
    "CONCOR29FEB24FUT": "71512",
    "CANBK29FEB24FUT": "71494",
    "BANKBARODA28MAR24FUT": "40445",
    "AMBUJACEM29FEB24FUT": "71453",
    "MCX28MAR24FUT": "66449",
    "DIVISLAB29FEB24FUT": "71555",
    "GRANULES29FEB24FUT": "71654",
    "WIPRO28MAR24FUT": "66541",
    "BALKRISIND29FEB24FUT": "71466",
    "DELTACORP29FEB24FUT": "71542",
    "HINDUNILVR29FEB24FUT": "71679",
    "AUROPHARMA28MAR24FUT": "38823",
    "IEX29FEB24FUT": "71686",
    "CUMMINSIND28MAR24FUT": "48028",
    "TATACOMM28MAR24FUT": "66517",
    "AUBANK29FEB24FUT": "71460",
    "BATAINDIA29FEB24FUT": "71470",
    "HAVELLS29FEB24FUT": "71668",
    "GODREJCP28MAR24FUT": "52104",
    "BALRAMCHIN29FEB24FUT": "71467",
    "ABBOTINDIA28MAR24FUT": "38780",
    "JINDALSTEL28MAR24FUT": "64119",
    "COROMANDEL29FEB24FUT": "71524",
    "TECHM28MAR24FUT": "66523",
    "ABBOTINDIA29FEB24FUT": "71444",
    "GODREJCP29FEB24FUT": "71650",
    "ASHOKLEY28MAR24FUT": "38800",
    "IDFC29FEB24FUT": "71684",
    "INDUSTOWER29FEB24FUT": "71695",
    "MUTHOOTFIN29FEB24FUT": "71853",
    "FINNIFTY26MAR24FUT": "35020",
    "COALINDIA28MAR24FUT": "48008",
    "NTPC28MAR24FUT": "66478",
    "INFY28MAR24FUT": "63644",
    "IGL28MAR24FUT": "62119",
    "DALBHARAT28MAR24FUT": "50761",
    "INFY29FEB24FUT": "71696",
    "INDUSINDBK29FEB24FUT": "71692",
    "NATIONALUM28MAR24FUT": "66465",
    "INDHOTEL28MAR24FUT": "62120",
    "NESTLEIND28MAR24FUT": "66476",
    "LTIM29FEB24FUT": "71837",
    "POWERGRID28MAR24FUT": "66499",
    "SHREECEM28MAR24FUT": "66509",
    "COROMANDEL28MAR24FUT": "48015",
    "HINDCOPPER28MAR24FUT": "59229",
    "METROPOLIS29FEB24FUT": "71847",
    "BAJAJ-AUTO28MAR24FUT": "38825",
    "LALPATHLAB29FEB24FUT": "71833",
    "BALKRISIND28MAR24FUT": "40442",
    "NAVINFLUOR29FEB24FUT": "71857",
    "BRITANNIA29FEB24FUT": "71492",
    "JKCEMENT28MAR24FUT": "64120",
    "HDFCLIFE28MAR24FUT": "52114",
    "HDFCAMC29FEB24FUT": "71670",
    "APOLLOTYRE29FEB24FUT": "71455",
    "GRANULES28MAR24FUT": "52106",
    "EXIDEIND28MAR24FUT": "50769",
    "M&M29FEB24FUT": "71840",
    "APOLLOHOSP28MAR24FUT": "38796",
    "NATIONALUM29FEB24FUT": "71854",
    "SRF28MAR24FUT": "66512",
    "IDFCFIRSTB29FEB24FUT": "71685",
    "SBILIFE28MAR24FUT": "66507",
    "TATAPOWER29FEB24FUT": "71907",
    "BOSCHLTD28MAR24FUT": "44197",
    "HINDPETRO29FEB24FUT": "71678",
    "DALBHARAT29FEB24FUT": "71535",
    "ABB29FEB24FUT": "71443",
    "CUMMINSIND29FEB24FUT": "71529",
    "PETRONET29FEB24FUT": "71867",
    "CIPLA28MAR24FUT": "46034",
    "ABFRL29FEB24FUT": "71446",
    "BSOFT28MAR24FUT": "45481",
    "TECHM29FEB24FUT": "71910",
    "IDFC28MAR24FUT": "60753",
    "KOTAKBANK28MAR24FUT": "64123",
    "PERSISTENT28MAR24FUT": "66488",
    "ABB28MAR24FUT": "38656",
    "MOTHERSON29FEB24FUT": "71850",
    "INDIAMART29FEB24FUT": "71690",
    "ADANIENT28MAR24FUT": "38786",
    "ATUL28MAR24FUT": "38815",
    "MPHASIS29FEB24FUT": "71851",
    "BAJAJ-AUTO29FEB24FUT": "71463",
    "TATACOMM29FEB24FUT": "71904",
    "LTIM28MAR24FUT": "66440",
    "MRF28MAR24FUT": "66455",
    "ULTRACEMCO28MAR24FUT": "66533",
    "L&TFH28MAR24FUT": "64124",
    "SAIL29FEB24FUT": "71892",
    "DRREDDY28MAR24FUT": "50766",
    "JINDALSTEL29FEB24FUT": "71812",
    "IDEA28MAR24FUT": "60752",
    "MGL28MAR24FUT": "66452",
    "OBEROIRLTY28MAR24FUT": "66479",
    "COALINDIA29FEB24FUT": "71499",
    "GODREJPROP28MAR24FUT": "52105",
    "BANDHANBNK29FEB24FUT": "71468",
    "PIIND28MAR24FUT": "66493",
    "BANKBARODA29FEB24FUT": "71469",
    "LT29FEB24FUT": "71836",
    "ASHOKLEY29FEB24FUT": "71456",
    "METROPOLIS28MAR24FUT": "66450",
    "POLYCAB29FEB24FUT": "71881",
    "ATUL29FEB24FUT": "71459",
    "SHRIRAMFIN29FEB24FUT": "71897",
    "PVRINOX29FEB24FUT": "71887",
    "MPHASIS28MAR24FUT": "66454",
    "LTTS28MAR24FUT": "66441",
    "HINDPETRO28MAR24FUT": "59230",
    "HINDALCO29FEB24FUT": "71674",
    "PEL28MAR24FUT": "66487",
    "IRCTC28MAR24FUT": "63647",
    "BHEL28MAR24FUT": "42925",
    "VOLTAS29FEB24FUT": "71919",
    "BHARATFORG29FEB24FUT": "71486",
    "ICICIBANK29FEB24FUT": "71680",
    "BERGEPAINT28MAR24FUT": "42913",
    "OFSS29FEB24FUT": "71862",
    "BPCL28MAR24FUT": "44199",
    "SBICARD29FEB24FUT": "71893",
    "SUNPHARMA29FEB24FUT": "71900",
    "ACC29FEB24FUT": "71448",
    "ICICIGI28MAR24FUT": "60748",
    "BALRAMCHIN28MAR24FUT": "40443",
    "RBLBANK28MAR24FUT": "66502",
    "CANFINHOME29FEB24FUT": "71495",
    "WIPRO29FEB24FUT": "71920",
    "PIDILITIND28MAR24FUT": "66491",
    "ITC29FEB24FUT": "71811",
    "TATASTEEL28MAR24FUT": "66521",
    "ASTRAL28MAR24FUT": "38814",
    "ADANIENT29FEB24FUT": "71449",
    "ONGC29FEB24FUT": "71863",
    "HDFCBANK28MAR24FUT": "52113",
    "DEEPAKNTR28MAR24FUT": "50762",
    "ZEEL28MAR24FUT": "66544",
    "MGL29FEB24FUT": "71849",
    "AXISBANK29FEB24FUT": "71462",
    "LT28MAR24FUT": "66439",
    "MCDOWELL-N29FEB24FUT": "71845",
    "HINDUNILVR28MAR24FUT": "59231",
    "POWERGRID29FEB24FUT": "71886",
    "PFC28MAR24FUT": "66490",
    "POLYCAB28MAR24FUT": "66498",
    "HAVELLS28MAR24FUT": "52110",
    "TATACHEM29FEB24FUT": "71903",
    "PAGEIND28MAR24FUT": "66482",
    "RAMCOCEM28MAR24FUT": "66501",
    "HINDALCO28MAR24FUT": "59228",
    "BEL28MAR24FUT": "42912",
    "ZYDUSLIFE29FEB24FUT": "71922",
    "HAL29FEB24FUT": "71667",
    "TATASTEEL29FEB24FUT": "71908",
    "DABUR28MAR24FUT": "50760",
    "TATAPOWER28MAR24FUT": "66520",
    "GAIL28MAR24FUT": "50774",
    "HEROMOTOCO28MAR24FUT": "59227",
    "TVSMOTOR29FEB24FUT": "71914",
    "MRF29FEB24FUT": "71852",
    "MANAPPURAM28MAR24FUT": "66445",
    "SYNGENE29FEB24FUT": "71902",
    "IPCALAB28MAR24FUT": "63646",
    "SUNTV28MAR24FUT": "66514",
    "GLENMARK28MAR24FUT": "52097",
    "SIEMENS28MAR24FUT": "66511",
    "APOLLOHOSP29FEB24FUT": "71454",
    "LAURUSLABS29FEB24FUT": "71834",
    
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> ONGC28MAR24FUT": "66481"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>