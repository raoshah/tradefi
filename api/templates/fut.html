<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {

            "BANKNIFTY29MAY25FUT": "57130",
    "FINNIFTY29MAY25FUT": "57131",
    "APOLLOTYRE29MAY25FUT": "57149",
    "ADANIENT29MAY25FUT": "57141",
    "CANBK29MAY25FUT": "57177",
    "BPCL29MAY25FUT": "57172",
    "DLF29MAY25FUT": "57197",
    "GLENMARK29MAY25FUT": "57209",
    "IIFL29MAY25FUT": "57270",
    "M&M29MAY25FUT": "57438",
    "MAXHEALTH29MAY25FUT": "57443",
    "MFSL29MAY25FUT": "57445",
    "NESTLEIND29MAY25FUT": "57469",
    "PATANJALI29MAY25FUT": "57485",
    "PRESTIGE29MAY25FUT": "57503",
    "RBLBANK29MAY25FUT": "57505",
    "TATACONSUM29MAY25FUT": "57530",
    "SBIN29MAY25FUT": "57515",
    "SAIL29MAY25FUT": "57512",
    "TATAPOWER29MAY25FUT": "57533",
    "TIINDIA29MAY25FUT": "57540",
    "TORNTPOWER29MAY25FUT": "57552",
    "ETERNAL29MAY25FUT": "57564",
    "ABCAPITAL29MAY25FUT": "57137",
    "AUBANK29MAY25FUT": "57154",
    "CIPLA29MAY25FUT": "57183",
    "COLPAL29MAY25FUT": "57186",
    "CHAMBLFERT29MAY25FUT": "57181",
    "CONCOR29MAY25FUT": "57187",
    "GRANULES29MAY25FUT": "57215",
    "GRASIM29MAY25FUT": "57216",
    "HDFCAMC29MAY25FUT": "57220",
    "IDEA29MAY25FUT": "57243",
    "INDIGO29MAY25FUT": "57279",
    "INDIANB29MAY25FUT": "57272",
    "MCX29MAY25FUT": "57444",
    "PERSISTENT29MAY25FUT": "57488",
    "POONAWALLA29MAY25FUT": "57499",
    "POWERGRID29MAY25FUT": "57502",
    "UNIONBANK29MAY25FUT": "57556",
    "SHRIRAMFIN29MAY25FUT": "57517",
    "WIPRO29MAY25FUT": "57562",
    "PNBHOUSING29MAY25FUT": "57090",
    "ABFRL29MAY25FUT": "57138",
    "AXISBANK29MAY25FUT": "57156",
    "BANDHANBNK29MAY25FUT": "57163",
    "CESC29MAY25FUT": "57179",
    "COALINDIA29MAY25FUT": "57184",
    "DALBHARAT29MAY25FUT": "57192",
    "ESCORTS29MAY25FUT": "57203",
    "FEDERALBNK29MAY25FUT": "57205",
    "HAL29MAY25FUT": "57217",
    "JSWENERGY29MAY25FUT": "57359",
    "INDHOTEL29MAY25FUT": "57271",
    "LICHSGFIN29MAY25FUT": "57385",
    "LODHA29MAY25FUT": "57393",
    "NTPC29MAY25FUT": "57474",
    "NYKAA29MAY25FUT": "57475",
    "PETRONET29MAY25FUT": "57489",
    "SBICARD29MAY25FUT": "57513",
    "TCS29MAY25FUT": "57538",
    "UNITDSPR29MAY25FUT": "57557",
    "UPL29MAY25FUT": "57558",
    "NIFTYNXT5029MAY25FUT": "57134",
    "AARTIIND29MAY25FUT": "57135",
    "ASHOKLEY29MAY25FUT": "57150",
    "BHARATFORG29MAY25FUT": "57167",
    "BANKINDIA29MAY25FUT": "57165",
    "BAJFINANCE29MAY25FUT": "57161",
    "CYIENT29MAY25FUT": "57190",
    "HINDPETRO29MAY25FUT": "57235",
    "HFCL29MAY25FUT": "57230",
    "HDFCBANK29MAY25FUT": "57221",
    "IOC29MAY25FUT": "57285",
    "INDUSTOWER29MAY25FUT": "57281",
    "INFY29MAY25FUT": "57282",
    "JINDALSTEL29MAY25FUT": "57356",
    "ITC29MAY25FUT": "57351",
    "KEI29MAY25FUT": "57375",
    "KPITTECH29MAY25FUT": "57377",
    "MARICO29MAY25FUT": "57441",
    "MARUTI29MAY25FUT": "57442",
    "NHPC29MAY25FUT": "57472",
    "RECLTD29MAY25FUT": "57506",
    "RELIANCE29MAY25FUT": "57507",
    "SHREECEM29MAY25FUT": "57516",
    "SRF29MAY25FUT": "57522",
    "TATACHEM29MAY25FUT": "57526",
    "ULTRACEMCO29MAY25FUT": "57555",
    "ANGELONE29MAY25FUT": "57146",
    "ADANIGREEN29MAY25FUT": "57142",
    "ASTRAL29MAY25FUT": "57152",
    "BAJAJFINSV29MAY25FUT": "57160",
    "BRITANNIA29MAY25FUT": "57173",
    "COFORGE29MAY25FUT": "57185",
    "DEEPAKNTR29MAY25FUT": "57193",
    "DELHIVERY29MAY25FUT": "57194",
    "DRREDDY29MAY25FUT": "57199",
    "EXIDEIND29MAY25FUT": "57204",
    "GODREJPROP29MAY25FUT": "57214",
    "HCLTECH29MAY25FUT": "57219",
    "ICICIBANK29MAY25FUT": "57240",
    "ICICIPRULI29MAY25FUT": "57242",
    "JSL29MAY25FUT": "57358",
    "IRFC29MAY25FUT": "57350",
    "LAURUSLABS29MAY25FUT": "57384",
    "LICI29MAY25FUT": "57392",
    "LT29MAY25FUT": "57424",
    "LUPIN29MAY25FUT": "57427",
    "M&MFIN29MAY25FUT": "57439",
    "MOTHERSON29MAY25FUT": "57447",
    "NAUKRI29MAY25FUT": "57466",
    "MUTHOOTFIN29MAY25FUT": "57462",
    "PEL29MAY25FUT": "57487",
    "PHOENIXLTD29MAY25FUT": "57493",
    "RAMCOCEM29MAY25FUT": "57504",
    "SOLARINDS29MAY25FUT": "57520",
    "TATAMOTORS29MAY25FUT": "57532",
    "TRENT29MAY25FUT": "57553",
    "VBL29MAY25FUT": "57559",
    "YESBANK29MAY25FUT": "57563",
    "ZYDUSLIFE29MAY25FUT": "57565",
    "HINDZINC29MAY25FUT": "56961",
    "ALKEM29MAY25FUT": "57144",
    "ASIANPAINT29MAY25FUT": "57151",
    "BANKBARODA29MAY25FUT": "57164",
    "BSE29MAY25FUT": "57174",
    "BIOCON29MAY25FUT": "57170",
    "CDSL29MAY25FUT": "57178",
    "CUMMINSIND29MAY25FUT": "57189",
    "DMART29MAY25FUT": "57198",
    "EICHERMOT29MAY25FUT": "57202",
    "HEROMOTOCO29MAY25FUT": "57229",
    "KALYANKJIL29MAY25FUT": "57374",
    "MGL29MAY25FUT": "57446",
    "LTIM29MAY25FUT": "57426",
    "MRF29MAY25FUT": "57451",
    "NBCC29MAY25FUT": "57467",
    "NCC29MAY25FUT": "57468",
    "OFSS29MAY25FUT": "57477",
    "ONGC29MAY25FUT": "57479",
    "PAGEIND29MAY25FUT": "57480",
    "TVSMOTOR29MAY25FUT": "57554",
    "VOLTAS29MAY25FUT": "57561",
    "SUNPHARMA29MAY25FUT": "57523",
    "INOXWIND29MAY25FUT": "56999",
    "MIDCPNIFTY29MAY25FUT": "57132",
    "AMBUJACEM29MAY25FUT": "57145",
    "APOLLOHOSP29MAY25FUT": "57148",
    "AUROPHARMA29MAY25FUT": "57155",
    "BAJAJ-AUTO29MAY25FUT": "57157",
    "CROMPTON29MAY25FUT": "57188",
    "CGPOWER29MAY25FUT": "57180",
    "DABUR29MAY25FUT": "57191",
    "HAVELLS29MAY25FUT": "57218",
    "IEX29MAY25FUT": "57245",
    "JSWSTEEL29MAY25FUT": "57364",
    "IGL29MAY25FUT": "57267",
    "MANAPPURAM29MAY25FUT": "57440",
    "LTF29MAY25FUT": "57425",
    "MPHASIS29MAY25FUT": "57450",
    "OBEROIRLTY29MAY25FUT": "57476",
    "PAYTM29MAY25FUT": "57486",
    "PNB29MAY25FUT": "57496",
    "SBILIFE29MAY25FUT": "57514",
    "TATAELXSI29MAY25FUT": "57531",
    "SONACOMS29MAY25FUT": "57521",
    "TATASTEEL29MAY25FUT": "57534",
    "TORNTPHARM29MAY25FUT": "57547",
    "VEDL29MAY25FUT": "57560",
    "NIFTY29MAY25FUT": "57133",
    "ADANIENSOL29MAY25FUT": "57140",
    "ATGL29MAY25FUT": "57153",
    "BEL29MAY25FUT": "57166",
    "BHEL29MAY25FUT": "57169",
    "BOSCHLTD29MAY25FUT": "57171",
    "CAMS29MAY25FUT": "57176",
    "CHOLAFIN29MAY25FUT": "57182",
    "DIXON29MAY25FUT": "57196",
    "HINDCOPPER29MAY25FUT": "57234",
    "GAIL29MAY25FUT": "57208",
    "GMRAIRPORT29MAY25FUT": "57210",
    "HINDUNILVR29MAY25FUT": "57236",
    "HUDCO29MAY25FUT": "57237",
    "ICICIGI29MAY25FUT": "57241",
    "IDFCFIRSTB29MAY25FUT": "57244",
    "IREDA29MAY25FUT": "57343",
    "IRB29MAY25FUT": "57286",
    "INDUSINDBK29MAY25FUT": "57280",
    "NATIONALUM29MAY25FUT": "57463",
    "NMDC29MAY25FUT": "57473",
    "OIL29MAY25FUT": "57478",
    "PIDILITIND29MAY25FUT": "57494",
    "PIIND29MAY25FUT": "57495",
    "SIEMENS29MAY25FUT": "57518",
    "SUPREMEIND29MAY25FUT": "57524",
    "TITAGARH29MAY25FUT": "57545",
    "TATACOMM29MAY25FUT": "57527",
    "ABB29MAY25FUT": "57136",
    "ACC29MAY25FUT": "57139",
    "ADANIPORTS29MAY25FUT": "57143",
    "APLAPOLLO29MAY25FUT": "57147",
    "BALKRISIND29MAY25FUT": "57162",
    "BHARTIARTL29MAY25FUT": "57168",
    "BSOFT29MAY25FUT": "57175",
    "DIVISLAB29MAY25FUT": "57195",
    "GODREJCP29MAY25FUT": "57211",
    "HINDALCO29MAY25FUT": "57231",
    "HDFCLIFE29MAY25FUT": "57228",
    "JIOFIN29MAY25FUT": "57357",
    "IRCTC29MAY25FUT": "57336",
    "JUBLFOOD29MAY25FUT": "57365",
    "KOTAKBANK29MAY25FUT": "57376",
    "PFC29MAY25FUT": "57492",
    "POLICYBZR29MAY25FUT": "57497",
    "POLYCAB29MAY25FUT": "57498",
    "TATATECH29MAY25FUT": "57537",
    "SJVN29MAY25FUT": "57519",
    "SYNGENE29MAY25FUT": "57525",
    "TECHM29MAY25FUT": "57539",
    "TITAN29MAY25FUT": "57546",
    "SILVER05MAY25FUT": "433350",
    "CRUDEOILM19MAY25FUT": "443450",
    "LEADMINI30MAY25FUT": "446489",
    "GOLDM05MAY25FUT": "448589",
    "NATGASMINI27MAY25FUT": "444206",
    "MENTHAOIL30MAY25FUT": "444541",
    "CRUDEOIL19MAY25FUT": "443449",
    "ALUMINIUM30MAY25FUT": "446487",
    "COTTONCNDY30MAY25FUT": "442170",
    "STEELREBAR30MAY25FUT": "446492",
    "ALUMINI30MAY25FUT": "446486",
    "LEAD30MAY25FUT": "446490",
    "ZINC30MAY25FUT": "446494",
    "MCXMETLDEX23MAY25FUT": "449533",
    "NATURALGAS27MAY25FUT": "444205",
    "GOLDGUINEA30MAY25FUT": "448162",
    "COPPER30MAY25FUT": "446488",
    "COTTONOIL30MAY25FUT": "448165",
    "NICKEL30MAY25FUT": "446491",
    "ZINCMINI30MAY25FUT": "446493",
    "GOLDPETAL30MAY25FUT": "448163",
    "MCXBULLDEX27MAY25FUT": "450133",

            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> GOLDTEN30MAY25FUT": "452776"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
