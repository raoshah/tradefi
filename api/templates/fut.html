<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeFi</title>
    <style>
        .share {
            text-align: center;
        }
    </style>
</head>

<body>
    <button style="text-align: center; padding: 2%; background-color: aqua;" id="refreshButton">Refresh</button>
    <button style="text-align: center; padding: 2%; background-color: aqua;"><a
            style="text-decoration: none; color: black;" href="/">Stocks</a></button>
            <button style="text-align: center; padding: 2%; background-color: aqua;" ><a style="text-decoration: none; color: black;" href="/backtest">Back Test</a></button>
    <div id="dataContainer"></div>


    <script>
        const symbol_token_dict = {
            "RECLTD27JUN24FUT": "58902",
    "IRCTC27JUN24FUT": "52177",
    "TATACONSUM27JUN24FUT": "63870",
    "INFY27JUN24FUT": "52168",
    "POWERGRID27JUN24FUT": "58894",
    "DIXON27JUN24FUT": "42116",
    "VOLTAS27JUN24FUT": "63884",
    "COFORGE27JUN24FUT": "42092",
    "MRF27JUN24FUT": "52245",
    "INDUSTOWER27JUN24FUT": "52166",
    "ABB27JUN24FUT": "35028",
    "SBILIFE27JUN24FUT": "58906",
    "PETRONET27JUN24FUT": "58876",
    "PNB27JUN24FUT": "58888",
    "HCLTECH27JUN24FUT": "42826",
    "BHARTIARTL27JUN24FUT": "40396",
    "LICHSGFIN27JUN24FUT": "52212",
    "PIIND27JUN24FUT": "58887",
    "GNFC27JUN24FUT": "42131",
    "JINDALSTEL27JUN24FUT": "52181",
    "HDFCLIFE27JUN24FUT": "44192",
    "UBL27JUN24FUT": "63880",
    "BAJAJFINSV27JUN24FUT": "38411",
    "IEX27JUN24FUT": "51860",
    "SYNGENE27JUN24FUT": "63867",
    "HAL27JUN24FUT": "42470",
    "MUTHOOTFIN27JUN24FUT": "52254",
    "METROPOLIS27JUN24FUT": "52238",
    "COROMANDEL27JUN24FUT": "42101",
    "EICHERMOT27JUN24FUT": "42119",
    "MPHASIS27JUN24FUT": "52244",
    "JUBLFOOD27JUN24FUT": "52189",
    "ZEEL27JUN24FUT": "63886",
    "APOLLOTYRE27JUN24FUT": "35203",
    "MANAPPURAM27JUN24FUT": "52221",
    "HINDCOPPER27JUN24FUT": "45185",
    "DLF27JUN24FUT": "42117",
    "ADANIPORTS27JUN24FUT": "35074",
    "ZYDUSLIFE27JUN24FUT": "63887",
    "SHRIRAMFIN27JUN24FUT": "63862",
    "AXISBANK27JUN24FUT": "38079",
    "BALRAMCHIN27JUN24FUT": "38621",
    "HDFCBANK27JUN24FUT": "44191",
    "LTTS27JUN24FUT": "52216",
    "LALPATHLAB27JUN24FUT": "52208",
    "IGL27JUN24FUT": "51866",
    "LAURUSLABS27JUN24FUT": "52209",
    "TECHM27JUN24FUT": "63875",
    "TITAN27JUN24FUT": "63876",
    "JSWSTEEL27JUN24FUT": "52188",
    "BALKRISIND27JUN24FUT": "38605",
    "ONGC27JUN24FUT": "58854",
    "TCS27JUN24FUT": "63874",
    "BANDHANBNK27JUN24FUT": "39139",
    "IPCALAB27JUN24FUT": "52170",
    "LT27JUN24FUT": "52213",
    "GAIL27JUN24FUT": "42126",
    "NIFTY27JUN24FUT": "35004",
    "M&M27JUN24FUT": "52218",
    "SBICARD27JUN24FUT": "58905",
    "TATACOMM27JUN24FUT": "63869",
    "IDEA27JUN24FUT": "49151",
    "CHOLAFIN27JUN24FUT": "42088",
    "PEL27JUN24FUT": "58866",
    "GRASIM27JUN24FUT": "42148",
    "PFC27JUN24FUT": "58877",
    "DABUR27JUN24FUT": "42111",
    "TATAMOTORS27JUN24FUT": "63871",
    "UPL27JUN24FUT": "63882",
    "GRANULES27JUN24FUT": "42146",
    "AMBUJACEM27JUN24FUT": "35200",
    "ICICIGI27JUN24FUT": "49149",
    "CONCOR27JUN24FUT": "42100",
    "BSOFT27JUN24FUT": "41230",
    "ASHOKLEY27JUN24FUT": "35210",
    "SAIL27JUN24FUT": "58904",
    "SHREECEM27JUN24FUT": "61367",
    "IOC27JUN24FUT": "52169",
    "NMDC27JUN24FUT": "52350",
    "NAUKRI27JUN24FUT": "52264",
    "INDIACEM27JUN24FUT": "51869",
    "BHEL27JUN24FUT": "40402",
    "ULTRACEMCO27JUN24FUT": "63881",
    "SUNPHARMA27JUN24FUT": "63865",
    "ABCAPITAL27JUN24FUT": "35030",
    "KOTAKBANK27JUN24FUT": "52194",
    "CANFINHOME27JUN24FUT": "42084",
    "MFSL27JUN24FUT": "52239",
    "AUBANK27JUN24FUT": "35232",
    "CHAMBLFERT27JUN24FUT": "42085",
    "PERSISTENT27JUN24FUT": "58874",
    "TVSMOTOR27JUN24FUT": "63879",
    "ABBOTINDIA27JUN24FUT": "35029",
    "HINDPETRO27JUN24FUT": "45186",
    "COLPAL27JUN24FUT": "42099",
    "BAJFINANCE27JUN24FUT": "38412",
    "HINDUNILVR27JUN24FUT": "47839",
    "ADANIENT27JUN24FUT": "35048",
    "NTPC27JUN24FUT": "55865",
    "PIDILITIND27JUN24FUT": "58878",
    "ABFRL27JUN24FUT": "35031",
    "APOLLOHOSP27JUN24FUT": "35201",
    "CIPLA27JUN24FUT": "42089",
    "ICICIPRULI27JUN24FUT": "49150",
    "BEL27JUN24FUT": "39798",
    "BOSCHLTD27JUN24FUT": "40405",
    "EXIDEIND27JUN24FUT": "42122",
    "MARUTI27JUN24FUT": "52232",
    "FEDERALBNK27JUN24FUT": "42124",
    "BIOCON27JUN24FUT": "40404",
    "AUROPHARMA27JUN24FUT": "36611",
    "RELIANCE27JUN24FUT": "58903",
    "RAMCOCEM27JUN24FUT": "58900",
    "RBLBANK27JUN24FUT": "58901",
    "MCDOWELL-N27JUN24FUT": "52236",
    "TATASTEEL27JUN24FUT": "63873",
    "COALINDIA27JUN24FUT": "42090",
    "BERGEPAINT27JUN24FUT": "40394",
    "NIFTYNXT5028JUN24FUT": "35238",
    "CROMPTON27JUN24FUT": "42102",
    "AARTIIND27JUN24FUT": "35005",
    "BHARATFORG27JUN24FUT": "40395",
    "CUB27JUN24FUT": "42106",
    "OBEROIRLTY27JUN24FUT": "55866",
    "IDFC27JUN24FUT": "49152",
    "ATUL27JUN24FUT": "35223",
    "LTF27JUN24FUT": "52195",
    "SUNTV27JUN24FUT": "63866",
    "ESCORTS27JUN24FUT": "42120",
    "HEROMOTOCO27JUN24FUT": "44193",
    "ALKEM27JUN24FUT": "35076",
    "DEEPAKNTR27JUN24FUT": "42113",
    "SBIN27JUN24FUT": "61363",
    "TRENT27JUN24FUT": "63878",
    "ITC27JUN24FUT": "52178",
    "PAGEIND27JUN24FUT": "58865",
    "PVRINOX27JUN24FUT": "58899",
    "JKCEMENT27JUN24FUT": "52182",
    "M&MFIN27JUN24FUT": "52219",
    "TATAPOWER27JUN24FUT": "63872",
    "MCX27JUN24FUT": "52237",
    "OFSS27JUN24FUT": "58853",
    "LTIM27JUN24FUT": "52215",
    "INDIAMART27JUN24FUT": "51871",
    "GLENMARK27JUN24FUT": "42127",
    "NAVINFLUOR27JUN24FUT": "52265",
    "ASIANPAINT27JUN24FUT": "35213",
    "GODREJPROP27JUN24FUT": "42145",
    "BPCL27JUN24FUT": "41222",
    "TORNTPHARM27JUN24FUT": "63877",
    "MIDCPNIFTY24JUN24FUT": "35025",
    "GODREJCP27JUN24FUT": "42135",
    "SRF27JUN24FUT": "63864",
    "NESTLEIND27JUN24FUT": "52349",
    "GUJGASLTD27JUN24FUT": "42149",
    "INDUSINDBK27JUN24FUT": "51878",
    "DALBHARAT27JUN24FUT": "42112",
    "NATIONALUM27JUN24FUT": "52255",
    "WIPRO27JUN24FUT": "63885",
    "HINDALCO27JUN24FUT": "44194",
    "FINNIFTY25JUN24FUT": "35152",
    "VEDL27JUN24FUT": "63883",
    "SIEMENS27JUN24FUT": "63863",
    "BANKBARODA27JUN24FUT": "39140",
    "MGL27JUN24FUT": "52242",
    "ACC27JUN24FUT": "35047",
    "MOTHERSON27JUN24FUT": "52243",
    "IDFCFIRSTB27JUN24FUT": "51859",
    "LUPIN27JUN24FUT": "52217",
    "HDFCAMC27JUN24FUT": "42834",
    "DRREDDY27JUN24FUT": "42118",
    "MARICO27JUN24FUT": "52231",
    "GMRINFRA27JUN24FUT": "42130",
    "ASTRAL27JUN24FUT": "35216",
    "TATACHEM27JUN24FUT": "63868",
    "CUMMINSIND27JUN24FUT": "42107",
    "BANKNIFTY26JUN24FUT": "35020",
    "INDIGO27JUN24FUT": "51874",
    "POLYCAB27JUN24FUT": "58893",
    "BAJAJ-AUTO27JUN24FUT": "38080",
    "BRITANNIA27JUN24FUT": "41223",
    "HAVELLS27JUN24FUT": "42471",
    "CANBK27JUN24FUT": "41235",
    "DIVISLAB27JUN24FUT": "42114",
    "ICICIBANK27JUN24FUT": "47840",
    "INDHOTEL27JUN24FUT": "51868",
            "THIS IS LAST >>>>>>REFRESH__AGAIN>>>>>> BATAINDIA27JUN24FUT": "39797"
        };

        async function fetchCandleDataSequential(tokens) {
            for (let token of tokens) {
                const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token).replace(/-EQ$/, '');
                try {
                    const response = await fetch(`/get_fut_data/${token}/${tokenName}`);
                    const data = await response.json();
                    displayData(token, data);
                } catch (error) {
                    console.error(`Error fetching data for token ${token}:`, error);
                }
            }
        }

        function displayData(token, data) {
            const dataContainer = document.getElementById('dataContainer');

            const tokenName = Object.keys(symbol_token_dict).find(key => symbol_token_dict[key] === token);
            const today_len = data.data.length - 1;
            const yesterday_len = data.data.length - 2;
            const todayHigh = parseFloat(data.data[today_len]['2']);
            const todayLow = parseFloat(data.data[today_len]['3']);
            const yesterdayHigh = parseFloat(data.data[yesterday_len]['2']);
            const yesterdayLow = parseFloat(data.data[yesterday_len]['3']);
            const todayVol = parseFloat(data.data[today_len]['5']);
            const yesterdayVol = parseFloat(data.data[yesterday_len]['5']);

            const div = document.createElement('div');
            div.innerHTML = ` <br> <p class='share' > <b>${tokenName}:</b> ${JSON.stringify(data.data[today_len]['4'])}</p>
            <p class='share' > <b>Today:</b>  High: ${todayHigh} -- Low: ${todayLow} -- Volume: ${todayVol} </p>
            <p class='share' > <b>Yesterday:</b>  High: ${yesterdayHigh} -- Low: ${yesterdayLow} -- Volume: ${yesterdayVol} </p>
            <hr>`;



            if (todayHigh > yesterdayHigh && todayLow < yesterdayLow) {
                div.style.color = 'green';
                div.style.backgroundColor = 'chartreuse';
            } else {
                div.style.color = 'black';
            }


            if (dataContainer.firstChild) {
                dataContainer.insertBefore(div, dataContainer.firstChild);
            } else {
                dataContainer.appendChild(div);
            }
        }

        const tokens = Object.values(symbol_token_dict);
        console.log(tokens)

        fetchCandleDataSequential(tokens);

        function refreshData() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            fetchCandleDataSequential(tokens);
        }
        document.getElementById('refreshButton').addEventListener('click', refreshData);
    </script>

</body>

</html>
